import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";
import { github, vsDark } from "@code-surfer/themes";
import NotesCodeSurfer from "./src/NotesCodeSurfer";

export const theme = vsDark;

# Hello ðŸ‘‹

You are using [MDX Deck](https://github.com/jxnblk/mdx-deck) and [Code Surfer](https://codesurfer.pomb.us)

---

<NotesCodeSurfer>

```notes checkout:react-local-state/1
Before we start coding, let's get familiar with
the code that Matt -our awesome product designer-
has prepared for us. Here we have the root
component, which has two main sections:

- The Orders component
- And the Currencies

and then, here in the middle: we have a button
for adding orders and these OrderTotal component
which renders the total sum of the
base-currency-price of the orders.

Perfect! Now, let's have a quick look at
the Orders and the Currencies
```

```jsx 86:97 file="./codeblocks/react/01_startingpoint.tsx" subtitle="Starting point"
App;
```

```notes
The Orders component is just a Table that
renders the different Orders, using the
OrdersLine Component.

Also, we notice that the initial orders are
currently hardcoded and they com from the
initialOrders which is imported from the utils
file.
```

```diff 70:78
  Orders
```

```notes
The Orderline component: very straightforward.
It gets an Order through props and it renders
its properties.
Its worth noting, though, that the base-cc-price,
which is a computed field, is currenctly hardcoded.
```

```diff 55:68
  Orderline
```

```notes
The Currencies Component is alost identical
to the Orders component: just a table with
different columns and it renders a CurrencyRate
row for each currency.

Like with the orders, the currencies are
currently being hardcoded from the
`initialCurrencyRates` also come from the utils file.
```

```diff 23:32
  Currencies
```

```notes
The CurrencyRate component: this is the one 
that it's used for editting the currencies
and it's also very straightforward:

It renders a currency, and it's rate value,
which can be editted through the NumberInput
component.

Awesome! Now let's start coding!
```

```diff 11:21
```

```notes checkout:react-local-state/2
We have noticed that the currencies are
being used in the 2 main components. So,
this is data that needs to be accessed by
different components at different levels,
let's put use React Context to have them
easily available.

We create a hook to easily access the
currencies, and a CurrenciesProvider that
we will use in our root component.
```

```jsx 12:23 file="./codeblocks/react/02_1currencyContext.tsx"
```

```notes
Let's use the `useCurrencies` hook.
```

```diff 37:46
```

```jsx 37:46 file="./codeblocks/react/02_2currencyContext.tsx"
```

```notes
Again...
```

```diff 48:67
```

```jsx 48:67 file="./codeblocks/react/02_3currencyContext.tsx"
```

```notes
And let's use the CurrenciesProvider
in our root component.

Ok, that wasn't too hard!
```

```diff 100:111
```

```jsx 101,112 file="./codeblocks/react/02_4currencyContext.tsx"
```

```notes
Next, we will make sure that the
Exchanges rate section works as it's
supposed to.
```

```diff 25:35
```

```notes checkout:react-local-state/3
Easy peasy! `useState` here and that's
it!.

I mean, we shouldn't be lifting
state unless we have to, right?

Look at that! This is working just great,
and without any annoying re-renders
on the components that are not concerned
with the currency that we just updated.

Now  that we are done with
the Exchanges Rate section
let's move on to the Orders
section.
```

```jsx 26,31 file="./codeblocks/react/03_exchangeRate.tsx"
```

```notes
Let's first make sure that the price and
the currency of each order get
properly updated.
```

```diff 69:82
```

```notes checkout:react-local-state/4
Once again, a couple of `useState`
here and we are done! Let's make sure
that this is working correctly...

Amazing! Look at that: we got 80% of
the functionality working with just 3
`useState`.

Ok, now let's make sure that the
base-currency-price gets properly updated...

Oh, wait! shut! Mmmm.. In order to compute
this value we will need to know the rate
of the selected currency.

Well, that's ok, we just need to lift
the state of the currency-rates, right?
No big deal... Let's do it.
```

```jsx file="./codeblocks/react/04_orderLinePrice.tsx" subtitle="Add price state"
```

```notes
Let's just create another Context for
the currencyRates.
```

```diff 12:23
```

```notes checkout:react-local-state/5
we create the useCurencyRates hook to
easily access the state of the
currencyRates and a ContextProvider
that we will place in the already
existing Currencies Provider.
```

```jsx 19:23,29,31 file="./codeblocks/react/05_1liftCurrencyRates.tsx"
```

```notes
then we replace the useState with
our `useCurrencyRatesHook` and that's
it!

Lifting state it's always a bit of
a pain, but it's not that bad, right?

Ok, now let's make sure that the
currency rates are still working...

Yep, they do work, but wait...
Oh, cmon, now every single row re-renders?

Oh, of course, because now every time
that a currency-rate changes the whole
record changes... We could prevent
the re-renders if the Orders component
used the hook

```

```diff 36:46
```

```jsx 37:38,45:47 file="./codeblocks/react/05_2liftCurrencyRates.tsx"
```

```notes checkout:react-local-state/7
Avoid rerenders
```

```diff 36:63
```

```jsx 36:40,57,60:66 file="./codeblocks/react/06_avoidRerenders.tsx" subtitle="Avoid rerenders"
```

```diff 93:108
```

```notes checkout:react-local-state/8
Price rate
```

```jsx 97:98,108 file="./codeblocks/react/07_orderLinePrice.tsx" subtitle="Price rate"
```

```diff 15:55 subtitle="Lift orders state"
```

```notes checkout:react-local-state/9
Lift orders state
```

```jsx 44:80 file="./codeblocks/react/08_1liftOrdersState.tsx"
```

```jsx 82:93 file="./codeblocks/react/08_2liftOrdersState.tsx"
```

```diff 171:180
```

```jsx 172:173,177:182 file="./codeblocks/react/08_3liftOrdersState.tsx"
```

```diff 152:169
```

```jsx 152:156,164:166,172:174 file="./codeblocks/react/08_4liftOrdersState.tsx"
```

```diff 204:217
```

```jsx 206,217 file="./codeblocks/react/08_5liftOrdersState.tsx"
```

```diff 211 subtitle="Add order button"
```

```notes checkout:react-local-state/10
Add order button
```

```jsx 201:212,226 file="./codeblocks/react/09_addOrderButton.tsx"

```

```notes checkout:react-local-state/11
Total
```

```diff 214:217
```

```jsx file="./codeblocks/react/10_calculateTotal.tsx" subtitle="Calculate total"

```

</NotesCodeSurfer>

---

<NotesCodeSurfer>

```jsx 86:97 file="./codeblocks/react-rxjs/01_startingpoint.tsx"
```

```jsx 13 file="./codeblocks/react-rxjs/02_1useCurrencies.tsx"
```

```diff 28
```

```jsx 28 file="./codeblocks/react-rxjs/02_2useCurrencies.tsx"
```

```diff 42
```

```jsx 42 file="./codeblocks/react-rxjs/02_3useCurrencies.tsx"
```

```jsx 15:19 file="./codeblocks/react-rxjs/03_1exchangeCurrencies.tsx"
```

```diff 21:31
```

```jsx 23,30:32 file="./codeblocks/react-rxjs/03_2exchangeCurrencies.tsx"
```

```jsx 22:36 file="./codeblocks/react-rxjs/04_1orderLinePriceCurrency.tsx"
```

```diff 102:111
```

```jsx 103,107:109 file="./codeblocks/react-rxjs/04_2orderLinePriceCurrency.tsx"
```

```diff 87:100
```

```jsx 88,95:97,103:105 file="./codeblocks/react-rxjs/04_3orderLinePriceCurrency.tsx"
```

```diff 28:36
```

```jsx 18,34:37,42 file="./codeblocks/react-rxjs/05_1orderLineBaseCurrency.tsx"
```

```diff 116
```

```jsx 116 file="./codeblocks/react-rxjs/05_2orderLineBaseCurrency.tsx"
```

```diff 24
```

```jsx 25:33,39 file="./codeblocks/react-rxjs/06_1addOrder.tsx"
```

```diff 153
```

```jsx 153 file="./codeblocks/react-rxjs/06_2addOrder.tsx"
```

```diff 27,51
```

```jsx 27,55:58 file="./codeblocks/react-rxjs/07_1Total.tsx"
```

```diff 149:152
```

```jsx 150 file="./codeblocks/react-rxjs/07_2Total.tsx"
```

```jsx 155,166 file="./codeblocks/react-rxjs/07_3Total.tsx"
```

```diff 141:143
```

```jsx 141 file="./codeblocks/react-rxjs/07_4Total.tsx"
```

```diff 110
```

```jsx 111 file="./codeblocks/react-rxjs/08_perf.tsx"
```

</NotesCodeSurfer>

---

<CodeSurferColumns themes={[vsDark, github]}>

<Step>

```jsx file="./codeblocks/react/01_startingpoint.tsx"
```

```jsx file="./codeblocks/react-rxjs/01_startingpoint.tsx"
```

</Step>

<Step>

```jsx file="./codeblocks/react/10_calculateTotal.tsx"
```

```jsx file="./codeblocks/react-rxjs/08_perf.tsx"
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns themes={[vsDark, github]}>

<Step>

```jsx file="./codeblocks/react/01_startingpoint.tsx"
```

```jsx file="./codeblocks/react-rxjs/01_startingpoint.tsx"
```

</Step>

<Step>

```jsx file="./codeblocks/react/02_4currencyContext.tsx"
```

```jsx file="./codeblocks/react-rxjs/02_3useCurrencies.tsx"
```

</Step>

<Step>

```jsx file="./codeblocks/react/03_exchangeRate.tsx"
```

```jsx file="./codeblocks/react-rxjs/03_2exchangeCurrencies.tsx"
```

</Step>

<Step>

```jsx file="./codeblocks/react/04_orderLinePrice.tsx"
```

```jsx file="./codeblocks/react-rxjs/04_3orderLinePriceCurrency.tsx"
```

</Step>

<Step>

```jsx file="./codeblocks/react/07_orderLinePrice.tsx"
```

```jsx file="./codeblocks/react-rxjs/05_2orderLineBaseCurrency.tsx"
```

</Step>

<Step>

```jsx file="./codeblocks/react/09_addOrderButton.tsx"
```

```jsx file="./codeblocks/react-rxjs/06_2addOrder.tsx"
```

</Step>

<Step>

```jsx file="./codeblocks/react/10_calculateTotal.tsx"
```

```jsx file="./codeblocks/react-rxjs/08_perf.tsx"
```

</Step>

</CodeSurferColumns>
